---
name: jwt
description: JWT utility functions for signing and verifying tokens
dependencies:
  - jsonwebtoken
devDependencies:
  - "@types/jsonwebtoken"
files:
  - name: utils/jwt.ts
---
import jwt, { SignOptions, VerifyOptions } from 'jsonwebtoken';

const JWT_SECRET = process.env.JWT_SECRET || 'changeme';

/**
 * Signs a payload to create a JWT
 * @param payload Data to encode
 * @param options JWT sign options (expiresIn, etc.)
 */
export const signToken = (payload: object, options?: SignOptions): string => {
  return jwt.sign(payload, JWT_SECRET, {
    expiresIn: '1h', // Default expiration
    ...options,
  });
};

/**
 * Verifies a JWT and returns the decoded payload
 * @param token The JWT string
 */
export const verifyToken = <T = any>(token: string, options?: VerifyOptions): T => {
  return jwt.verify(token, JWT_SECRET, options) as T;
};

/**
 * Decodes a JWT without verifying signature
 * @param token The JWT string
 */
export const decodeToken = <T = any>(token: string): T | null => {
  return jwt.decode(token) as T;
};
